<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 6 Model Selection | Intro Regression</title>
  <meta name="description" content="An electronic book with assignments and in-class activities to help students apply concepts in an intermediate-level regression analysis course. The primary focus of this text is application and computing; there are also supplemental math notes for some topics.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content=" 6 Model Selection | Intro Regression" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.introregression.org/" />
  <meta property="og:image" content="https://www.introregression.org/img/introregression-sticker.png" />
  <meta property="og:description" content="An electronic book with assignments and in-class activities to help students apply concepts in an intermediate-level regression analysis course. The primary focus of this text is application and computing; there are also supplemental math notes for some topics." />
  <meta name="github-repo" content="matackett/intro-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 6 Model Selection | Intro Regression" />
  
  <meta name="twitter:description" content="An electronic book with assignments and in-class activities to help students apply concepts in an intermediate-level regression analysis course. The primary focus of this text is application and computing; there are also supplemental math notes for some topics." />
  <meta name="twitter:image" content="https://www.introregression.org/img/introregression-sticker.png" />

<meta name="author" content="Maria Tackett">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="img/introregression-sticker.png">
  <link rel="shortcut icon" href="img/introregression-sticker.png" type="image/x-icon">
<link rel="prev" href="5-mlr.html">
<link rel="next" href="7-logistic.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to Intro Regression!</a></li>
<li class="chapter" data-level="1" data-path="1-getstarted.html"><a href="1-getstarted.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="1-getstarted.html"><a href="1-getstarted.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="1-getstarted.html"><a href="1-getstarted.html#intro-statistics-review"><i class="fa fa-check"></i><b>1.2</b> Intro Statistics Review</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-instr.html"><a href="2-instr.html"><i class="fa fa-check"></i><b>2</b> Notes for Instructors</a><ul>
<li class="chapter" data-level="2.1" data-path="2-instr.html"><a href="2-instr.html#setting-up-your-course"><i class="fa fa-check"></i><b>2.1</b> Setting up your course</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-instr.html"><a href="2-instr.html#github"><i class="fa fa-check"></i><b>2.1.1</b> GitHub</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-instr.html"><a href="2-instr.html#rstudio-cloud"><i class="fa fa-check"></i><b>2.1.2</b> RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-instr.html"><a href="2-instr.html#making-assignments"><i class="fa fa-check"></i><b>2.2</b> Making Assignments</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-instr.html"><a href="2-instr.html#github-1"><i class="fa fa-check"></i><b>2.2.1</b> GitHub</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-instr.html"><a href="2-instr.html#rstudio-cloud-1"><i class="fa fa-check"></i><b>2.2.2</b> RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-instr.html"><a href="2-instr.html#additional-resources"><i class="fa fa-check"></i><b>2.3</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-slr.html"><a href="3-slr.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="3-slr.html"><a href="3-slr.html#comp-college-admissions"><i class="fa fa-check"></i><b>3.1</b> COMP: College Admissions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-slr.html"><a href="3-slr.html#packages"><i class="fa fa-check"></i><b>3.1.1</b> Packages</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-slr.html"><a href="3-slr.html#data"><i class="fa fa-check"></i><b>3.1.2</b> Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-slr.html"><a href="3-slr.html#exercises"><i class="fa fa-check"></i><b>3.1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-slr.html"><a href="3-slr.html#in-class-advertising-sales"><i class="fa fa-check"></i><b>3.2</b> IN-CLASS: Advertising &amp; Sales</a><ul>
<li class="chapter" data-level="3.2.1" data-path="3-slr.html"><a href="3-slr.html#data-and-packages"><i class="fa fa-check"></i><b>3.2.1</b> Data and packages</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-slr.html"><a href="3-slr.html#analysis"><i class="fa fa-check"></i><b>3.2.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-slr.html"><a href="3-slr.html#in-class-carbohydrates-in-beer"><i class="fa fa-check"></i><b>3.3</b> IN-CLASS: Carbohydrates in Beer</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-anova.html"><a href="4-anova.html"><i class="fa fa-check"></i><b>4</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="4.1" data-path="4-anova.html"><a href="4-anova.html#comp-diamonds"><i class="fa fa-check"></i><b>4.1</b> COMP: Diamonds</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-anova.html"><a href="4-anova.html#packages-1"><i class="fa fa-check"></i><b>4.1.1</b> Packages</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-anova.html"><a href="4-anova.html#data-1"><i class="fa fa-check"></i><b>4.1.2</b> Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="4-anova.html"><a href="4-anova.html#exercises-1"><i class="fa fa-check"></i><b>4.1.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-mlr.html"><a href="5-mlr.html"><i class="fa fa-check"></i><b>5</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="5-mlr.html"><a href="5-mlr.html#comp-houses-in-king-county"><i class="fa fa-check"></i><b>5.1</b> COMP: Houses in King County</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-mlr.html"><a href="5-mlr.html#packages-2"><i class="fa fa-check"></i><b>5.1.1</b> Packages</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-mlr.html"><a href="5-mlr.html#data-2"><i class="fa fa-check"></i><b>5.1.2</b> Data</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-mlr.html"><a href="5-mlr.html#exercises-2"><i class="fa fa-check"></i><b>5.1.3</b> Exercises</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-mlr.html"><a href="5-mlr.html#acknowledgement"><i class="fa fa-check"></i><b>5.1.4</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-mlr.html"><a href="5-mlr.html#comp-airbnb-in-asheville-nc"><i class="fa fa-check"></i><b>5.2</b> COMP: Airbnb in Asheville, NC</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-mlr.html"><a href="5-mlr.html#packages-3"><i class="fa fa-check"></i><b>5.2.1</b> Packages</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-mlr.html"><a href="5-mlr.html#data-3"><i class="fa fa-check"></i><b>5.2.2</b> Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-mlr.html"><a href="5-mlr.html#exercises-3"><i class="fa fa-check"></i><b>5.2.3</b> Exercises</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-mlr.html"><a href="5-mlr.html#acknowledgement-1"><i class="fa fa-check"></i><b>5.2.4</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-mlr.html"><a href="5-mlr.html#in-class-wages"><i class="fa fa-check"></i><b>5.3</b> IN-CLASS: Wages</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-mlr.html"><a href="5-mlr.html#initial-model"><i class="fa fa-check"></i><b>5.3.1</b> Initial model</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-mlr.html"><a href="5-mlr.html#model-with-mean-centered-variables"><i class="fa fa-check"></i><b>5.3.2</b> Model with mean-centered variables</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-mlr.html"><a href="5-mlr.html#model-with-indicator-variables"><i class="fa fa-check"></i><b>5.3.3</b> Model with indicator variables</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-mlr.html"><a href="5-mlr.html#notes-matrix-form-of-linear-regression"><i class="fa fa-check"></i><b>5.4</b> NOTES: Matrix Form of Linear Regression</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-mlr.html"><a href="5-mlr.html#introduction"><i class="fa fa-check"></i><b>5.4.1</b> Introduction</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-mlr.html"><a href="5-mlr.html#matrix-form-for-the-regression-model"><i class="fa fa-check"></i><b>5.4.2</b> Matrix Form for the Regression Model</a></li>
<li class="chapter" data-level="5.4.3" data-path="5-mlr.html"><a href="5-mlr.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>5.4.3</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="5.4.4" data-path="5-mlr.html"><a href="5-mlr.html#variance-covariance-matrix-of-the-coefficients"><i class="fa fa-check"></i><b>5.4.4</b> Variance-covariance matrix of the coefficients</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5-mlr.html"><a href="5-mlr.html#notes-log-transformations"><i class="fa fa-check"></i><b>5.5</b> NOTES: Log Transformations</a><ul>
<li class="chapter" data-level="5.5.1" data-path="5-mlr.html"><a href="5-mlr.html#log-transformation-on-the-response-variable"><i class="fa fa-check"></i><b>5.5.1</b> Log-transformation on the response variable</a></li>
<li class="chapter" data-level="5.5.2" data-path="5-mlr.html"><a href="5-mlr.html#log-transformation-on-the-predictor-variable"><i class="fa fa-check"></i><b>5.5.2</b> Log-transformation on the predictor variable</a></li>
<li class="chapter" data-level="5.5.3" data-path="5-mlr.html"><a href="5-mlr.html#log-transformation-on-the-the-response-and-predictor-variable"><i class="fa fa-check"></i><b>5.5.3</b> Log-transformation on the the response and predictor variable</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="5-mlr.html"><a href="5-mlr.html#notes-model-diagnostics"><i class="fa fa-check"></i><b>5.6</b> NOTES: Model Diagnostics</a><ul>
<li class="chapter" data-level="5.6.1" data-path="5-mlr.html"><a href="5-mlr.html#introduction-1"><i class="fa fa-check"></i><b>5.6.1</b> Introduction</a></li>
<li class="chapter" data-level="5.6.2" data-path="5-mlr.html"><a href="5-mlr.html#matrix-form-for-the-regression-model-1"><i class="fa fa-check"></i><b>5.6.2</b> Matrix Form for the Regression Model</a></li>
<li class="chapter" data-level="5.6.3" data-path="5-mlr.html"><a href="5-mlr.html#hat-matrix-leverage"><i class="fa fa-check"></i><b>5.6.3</b> Hat Matrix &amp; Leverage</a></li>
<li class="chapter" data-level="5.6.4" data-path="5-mlr.html"><a href="5-mlr.html#standardized-residuals"><i class="fa fa-check"></i><b>5.6.4</b> Standardized Residuals</a></li>
<li class="chapter" data-level="5.6.5" data-path="5-mlr.html"><a href="5-mlr.html#cooks-distance"><i class="fa fa-check"></i><b>5.6.5</b> Cook’s Distance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-select.html"><a href="6-select.html"><i class="fa fa-check"></i><b>6</b> Model Selection</a><ul>
<li class="chapter" data-level="6.1" data-path="6-select.html"><a href="6-select.html#comp-sats-and-mlb"><i class="fa fa-check"></i><b>6.1</b> COMP: SATs and MLB</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-select.html"><a href="6-select.html#packages-4"><i class="fa fa-check"></i><b>6.1.1</b> Packages</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-select.html"><a href="6-select.html#data-4"><i class="fa fa-check"></i><b>6.1.2</b> Data</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-select.html"><a href="6-select.html#exercises-4"><i class="fa fa-check"></i><b>6.1.3</b> Exercises</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-select.html"><a href="6-select.html#acknowledgements"><i class="fa fa-check"></i><b>6.1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-select.html"><a href="6-select.html#in-class-sats-by-state"><i class="fa fa-check"></i><b>6.2</b> IN-CLASS: SATs by State</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-select.html"><a href="6-select.html#backward-selection-manually"><i class="fa fa-check"></i><b>6.2.1</b> Backward selection “manually”</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-select.html"><a href="6-select.html#backward-selection-using-regsubsets"><i class="fa fa-check"></i><b>6.2.2</b> Backward selection using regsubsets</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-select.html"><a href="6-select.html#changing-selection-criteria"><i class="fa fa-check"></i><b>6.2.3</b> Changing selection criteria</a></li>
<li class="chapter" data-level="6.2.4" data-path="6-select.html"><a href="6-select.html#different-selection-procedure"><i class="fa fa-check"></i><b>6.2.4</b> Different selection procedure</a></li>
<li class="chapter" data-level="6.2.5" data-path="6-select.html"><a href="6-select.html#choosing-a-final-model"><i class="fa fa-check"></i><b>6.2.5</b> Choosing a final model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-select.html"><a href="6-select.html#notes-model-selection-criteria"><i class="fa fa-check"></i><b>6.3</b> NOTES: Model Selection Criteria</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-select.html"><a href="6-select.html#maximum-likelihood-estimation-of-boldsymbolbeta-and-sigma"><i class="fa fa-check"></i><b>6.3.1</b> Maximum Likelihood Estimation of <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="6.3.2" data-path="6-select.html"><a href="6-select.html#aic"><i class="fa fa-check"></i><b>6.3.2</b> AIC</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-select.html"><a href="6-select.html#bic"><i class="fa fa-check"></i><b>6.3.3</b> BIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-logistic.html"><a href="7-logistic.html"><i class="fa fa-check"></i><b>7</b> Logistic Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="7-logistic.html"><a href="7-logistic.html#comp-spotify"><i class="fa fa-check"></i><b>7.1</b> COMP: Spotify</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-logistic.html"><a href="7-logistic.html#packages-5"><i class="fa fa-check"></i><b>7.1.1</b> Packages</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-logistic.html"><a href="7-logistic.html#data-5"><i class="fa fa-check"></i><b>7.1.2</b> Data</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-logistic.html"><a href="7-logistic.html#exercises-5"><i class="fa fa-check"></i><b>7.1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-logistic.html"><a href="7-logistic.html#in-class-risk-of-heart-disease"><i class="fa fa-check"></i><b>7.2</b> IN-CLASS: Risk of Heart Disease</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-logistic.html"><a href="7-logistic.html#references"><i class="fa fa-check"></i><b>7.2.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html"><i class="fa fa-check"></i><b>8</b> Multinomial Logistic Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#comp-general-social-survey"><i class="fa fa-check"></i><b>8.1</b> COMP: General Social Survey</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#packages-6"><i class="fa fa-check"></i><b>8.1.1</b> Packages</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#data-6"><i class="fa fa-check"></i><b>8.1.2</b> Data</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#exercises-6"><i class="fa fa-check"></i><b>8.1.3</b> Exercises</a></li>
<li class="chapter" data-level="8.1.4" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#acknowledgements-1"><i class="fa fa-check"></i><b>8.1.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#in-class-sesame-street"><i class="fa fa-check"></i><b>8.2</b> IN-CLASS: Sesame Street</a><ul>
<li class="chapter" data-level="8.2.1" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#questions"><i class="fa fa-check"></i><b>8.2.1</b> Questions</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-multinom-logistic.html"><a href="8-multinom-logistic.html#references-1"><i class="fa fa-check"></i><b>8.2.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-special.html"><a href="9-special.html"><i class="fa fa-check"></i><b>9</b> Special Topics</a><ul>
<li class="chapter" data-level="9.1" data-path="9-special.html"><a href="9-special.html#comp-regression-start-to-finish"><i class="fa fa-check"></i><b>9.1</b> COMP: Regression Start to Finish</a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-special.html"><a href="9-special.html#packages-7"><i class="fa fa-check"></i><b>9.1.1</b> Packages</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-special.html"><a href="9-special.html#data-7"><i class="fa fa-check"></i><b>9.1.2</b> Data</a></li>
<li class="chapter" data-level="9.1.3" data-path="9-special.html"><a href="9-special.html#exercises-7"><i class="fa fa-check"></i><b>9.1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-special.html"><a href="9-special.html#in-class-missing-data-exercise"><i class="fa fa-check"></i><b>9.2</b> IN-CLASS: Missing Data Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-datasets.html"><a href="10-datasets.html"><i class="fa fa-check"></i><b>10</b> Data Sets</a></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="select" class="section level1">
<h1><span class="header-section-number"> 6</span> Model Selection</h1>
<div id="comp-sats-and-mlb" class="section level2">
<h2><span class="header-section-number">6.1</span> COMP: SATs and MLB</h2>
<p>The goal of today’s lab is to practice forward and backward model selection. In addition to practice with model selection functions in R, you will manually conduct a backward selection procedure to better understand what occurs when you use model selection functions.</p>
<div id="packages-4" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Packages</h3>
<p>You will need the following packages for today’s lab:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(leaps)
<span class="kw">library</span>(Sleuth3) <span class="co">#case1201 data</span>
<span class="kw">library</span>(ISLR) <span class="co">#Hitters data</span></code></pre></div>
</div>
<div id="data-4" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Data</h3>
<p>There are two datasets for this lab.</p>
<div id="part-i" class="section level4">
<h4><span class="header-section-number">6.1.2.1</span> Part I</h4>
<p>The dataset for Part I contains the SAT score (out of 1600) and other variables that may be associated with SAT performance for each of the 50 states in the U.S. The data is based on test takers for the 1982 exam. The following variables are in the dataset:</p>
<ul>
<li><strong><code>SAT</code></strong>: average total SAT score</li>
<li><strong><code>State</code></strong>: U.S. State</li>
<li><strong><code>Takers</code></strong>: percentage of high school seniors who took exam</li>
<li><strong><code>Income</code></strong>: median income of families of test-takers ($ hundreds)</li>
<li><strong><code>Years</code></strong>: average number of years test-takers had formal education in social sciences, natural sciences, and humanities</li>
<li><strong><code>Public</code></strong>: percentage of test-takers who attended public high schools</li>
<li><strong><code>Expend</code></strong>: total state expenditure on high schools ($ hundreds per student)</li>
<li><strong><code>Rank</code></strong>: median percentile rank of test-takers within their high school classes</li>
</ul>
</div>
<div id="part-ii" class="section level4">
<h4><span class="header-section-number">6.1.2.2</span> Part II</h4>
<p>The dataset for Part II contains the performance statistics and salaries of Major League Baseball players in the 1986 and 1987 seasons. The data is in the <code>Hitters</code> dataset in the <code>ISLR</code> package. Type <code>?Hitters</code> in the console to see the variables names and their definitions.</p>
</div>
</div>
<div id="exercises-4" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Exercises</h3>
<div id="part-i-1" class="section level4">
<h4><span class="header-section-number">6.1.3.1</span> Part I</h4>
<p>For the first part of the lab, you will return to the model selection activity you started in class using the SAT data. The data is in the <code>case1201</code> data frame in the <code>Sleuth3</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sat_scores &lt;-<span class="st"> </span>case1201 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>State) </code></pre></div>
<ol style="list-style-type: decimal">
<li>Manually perform backward selection using <span class="math inline">\(Adj. R^2\)</span> as the selection criterion. To help you get started, the full model and the code for the first set of models to test are below. Show each step of the selection process. Display the coefficients and <span class="math inline">\(Adj. R^2\)</span> of your final model.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">full_model &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend, <span class="dt">data =</span> sat_scores)</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>What is the best 5-variable model? Display the model output.</p></li>
<li><p>Use the <code>regsubsets</code> function to perform backward selection. What is the final model when <span class="math inline">\(Adj. R^2\)</span> is the selection criterion? Display the coefficients and the <span class="math inline">\(Adj. R^2\)</span> of the final model. <em>This should be the same result you got in Exercise 1.</em></p></li>
<li><p>What is the final model when <span class="math inline">\(BIC\)</span> is the selection criterion? Display the coefficients and the <span class="math inline">\(BIC\)</span> of the final model.</p></li>
<li>Compare the final models selected by <span class="math inline">\(Adj. R^2\)</span> and <span class="math inline">\(BIC\)</span>.
<ul>
<li>Do the models have the same number of predictors? Briefly explain.</li>
<li>Are the same predictor variables in each model? Briefly explain.</li>
</ul></li>
<li><p>Consider the comparisons made in the previous exercise. Are these differences what you would expect given the selection criteria used? Briefly explain.</p></li>
</ol>
</div>
<div id="part-ii-1" class="section level4">
<h4><span class="header-section-number">6.1.3.2</span> Part II</h4>
<p>The data for this part of the lab is the <code>Hitters</code> dataset in the <code>ISLR</code> package. Your goal is to fit a regression model that uses the performance statistics of baseball players to predictor their salary. There are 19 potential predictor variables, so you will use the <code>regsubsets</code> function to conduct forward selection to choose a final model.</p>
<ol start="7" style="list-style-type: decimal">
<li><p>Read through the data dictionary for the <code>Hitters</code> dataset. You can access it by typing <code>?Hitters</code> in the console. What is the difference between the variables <code>HmRun</code> and <code>CHmRun</code>?</p></li>
<li><p>Some observations have missing values for <code>Salary</code>. Filter the data, so only observations that have values for <code>Salary</code> are included. You will use this filtered data for the remainder of the lab.</p></li>
<li><p>Fill in the code below to conduct forward selection and save the results in an object called <code>sel_summary</code> (selection summary).</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The `nvmax` option indicates the maximum-sized variable subsets to consider in the model selection.</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regfit_forward &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(_______, ________, <span class="dt">method=</span><span class="st">&quot;forward&quot;</span>, <span class="dt">nvmax =</span> <span class="dv">19</span>)
sel_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(_______)</code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li>The object <code>sel_summary</code> contains the summary statistics for the best fit model containing <span class="math inline">\(k\)</span> predictors, where <span class="math inline">\(k = 1, \ldots, 19\)</span>. The object <code>sel_summary</code> is a list object, so it is cumbersome to extract the relevant summary statistics. Therefore, you can create a data frame called <code>summary_stats</code> such that each row represents the best fit model with <span class="math inline">\(k\)</span> predictors and each column is a summary statistic. For example, the second row contains the summary statistics of the best fit model that contains 2 variables.</li>
</ol>
<p>Fill in the code below to create the data frame <code>summary_stats</code> that includes the <span class="math inline">\(BIC\)</span>, <span class="math inline">\(R^2\)</span>, <span class="math inline">\(Adj. R^2\)</span>, and residual sum of squares (RSS) for each model in <code>sel_summary</code>. The data frame <code>summary_stats</code> will also include the column <code>np</code>, the number of predictors in the model represented on each row.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summary_stats &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">bic =</span> sel_summary<span class="op">$</span>bic, 
                       <span class="dt">adjr2 =</span> _______, 
                       <span class="dt">rsq =</span> _______,
                       <span class="dt">rss =</span> _______) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">np =</span> <span class="kw">row_number</span>()) <span class="co">#number of variables</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># See the [ggplot2 documentation](https://ggplot2.tidyverse.org/reference/geom_abline.html#arguments) for code to add a vertical line.</span></code></pre></div>
<ol start="11" style="list-style-type: decimal">
<li>Use the data in the <code>summary_stats</code> data frame to plot <span class="math inline">\(BIC\)</span> versus the number of predictors. Include a vertical line on your plot that shows the number of predictors for the overall final model you would select based on <span class="math inline">\(BIC\)</span>. Be sure your plot has clear and informative title and axes labels.
<ul>
<li>How does <span class="math inline">\(BIC\)</span> change as the number of predictors increases?</li>
<li>How many predictors are in the final model selected based on <span class="math inline">\(BIC\)</span>?</li>
</ul></li>
</ol>
<p><em>You can fill in the code below with either <code>max</code> or <code>min</code> to find the number of predictors in the final model selected based on <span class="math inline">\(BIC\)</span>.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">np_bic &lt;-<span class="st"> </span>summary_stats <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(bic <span class="op">==</span><span class="st"> </span><span class="kw">_____</span>(bic)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(np) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pull</span>()</code></pre></div>
<ol start="12" style="list-style-type: decimal">
<li>Use the data in the <code>summary_stats</code> data frame to plot <span class="math inline">\(Adj. R^2\)</span> versus the number of predictors. Include a vertical line on your plot that shows the number of predictors for the final model you would select based on <span class="math inline">\(Adj. R^2\)</span>. Be sure your plot has clear and informative title and axes labels.
<ul>
<li>How does <span class="math inline">\(Adj. R^2\)</span> change as the number of predictors increases?</li>
<li>How many predictors are in the final model selected based on <span class="math inline">\(Adj. R^2\)</span>?</li>
</ul></li>
<li>Use the data in the <code>summary_stats</code> data frame to plot <span class="math inline">\(R^2\)</span> versus the number of predictors. Include a vertical line on your plot that shows the number of predictors for the final model selected based on <span class="math inline">\(R^2\)</span>. Be sure your plot has clear and informative title and axes labels.
<ul>
<li>How does <span class="math inline">\(R^2\)</span> change as the number of predictors increases?</li>
<li>How many predictors are in the final model selected based on <span class="math inline">\(R^2\)</span>?</li>
</ul></li>
<li><p>Should <span class="math inline">\(R^2\)</span> be used as a model selection criterion? Briefly explain why or why not using your answers to Exercises 11 - 13.</p></li>
<li><p>Choose a final model to predict a baseball player’s <code>Salary</code> from his performance statistics. Display the variables, their coefficients, and the summary statistics from the <code>summary_stats</code> data frame for this model.</p></li>
<li>Briefly explain why you chose the model in the previous exercise.
<ul>
<li>Which model selection criteria did you use (<span class="math inline">\(BIC\)</span>, <span class="math inline">\(Adj. R^2\)</span>, <span class="math inline">\(R^2\)</span>)? Why?</li>
<li>What other factors did you consider besides the value of the model selection criteria?</li>
</ul></li>
</ol>
</div>
</div>
<div id="acknowledgements" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Acknowledgements</h3>
<p>Part II of this lab was inspired by Lab 6.5 in <a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning</a> and <a href="https://www.andrew.cmu.edu/user/achoulde/95791/homework/homework3.html">Variable Selection in Regression</a>.</p>
<hr />
</div>
</div>
<div id="in-class-sats-by-state" class="section level2">
<h2><span class="header-section-number">6.2</span> IN-CLASS: SATs by State</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(Sleuth3)
<span class="kw">library</span>(leaps)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sat_scores &lt;-<span class="st"> </span>case1201 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>State) <span class="co">#remove the state variable</span></code></pre></div>
<div id="backward-selection-manually" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Backward selection “manually”</h3>
<ul>
<li>Manually perform backward selection using Adj. <span class="math inline">\(R^2\)</span> as the selection criteria. Show each step of the selection process. To help you get started, the full model and the code for the first set of models to test are below. You will need to find Adj. <span class="math inline">\(R^2\)</span> for each model.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">full_model &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Expend <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Expend, <span class="dt">data =</span> sat_scores)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(SAT <span class="op">~</span><span class="st"> </span>Takers <span class="op">+</span><span class="st"> </span>Years <span class="op">+</span><span class="st"> </span>Public <span class="op">+</span><span class="st"> </span>Income <span class="op">+</span><span class="st"> </span>Rank, <span class="dt">data =</span> sat_scores)</code></pre></div>
<p>Continue the model selection until you have a final model. Show each step of the model selection process.</p>
</div>
<div id="backward-selection-using-regsubsets" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Backward selection using regsubsets</h3>
<ul>
<li>Use the <code>regsubsets</code> function to perform backward selection using Adj. <span class="math inline">\(R^2\)</span> as the selection criteria. Are the variables the same as the ones at you chose? Is the Adj. <span class="math inline">\(R^2\)</span> the same?</li>
</ul>
</div>
<div id="changing-selection-criteria" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Changing selection criteria</h3>
<ul>
<li><p>Use the <code>regsubsets</code> function to perform backward selection using BIC as the selection criteria. What variables were chosen for the follow model? How does this model compare to the one selected using Adj. <span class="math inline">\(R^2\)</span>?</p></li>
<li><p>Use the <code>step</code> function to perform backward selection using AIC as the selection criteria. What variables were chosen for the follow model? How does this model compare to the models chosen from the other selection criteria?</p></li>
</ul>
</div>
<div id="different-selection-procedure" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Different selection procedure</h3>
<ul>
<li><p>Use forward or stepwise selection to choose a model. Choose the criteria you will use to select the model.</p></li>
<li><p>How does this model compare to the previous selected models?</p></li>
</ul>
</div>
<div id="choosing-a-final-model" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Choosing a final model</h3>
<ul>
<li>You likely have at least 2 different models chosen by the various model selection procedures. Which variables will you include in your final model? Why did you choose this to be your final model?</li>
</ul>
<hr />
</div>
</div>
<div id="notes-model-selection-criteria" class="section level2">
<h2><span class="header-section-number">6.3</span> NOTES: Model Selection Criteria</h2>
<p>This document discusses some of the mathematical details of Akaike’s Information Criterion (AIC) and Schwarz’s Bayesian Information Criterion (BIC). We assume the reader knowledge of the matrix form for multiple linear regression.Please see <a href="https://github.com/STA210-Sp19/supplemental-notes/blob/master/regression-basics-matrix.pdf">Matrix Form of Linear Regression</a> for a review.</p>
<div id="maximum-likelihood-estimation-of-boldsymbolbeta-and-sigma" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Maximum Likelihood Estimation of <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma\)</span></h3>
<p>To understand the formulas for AIC and BIC, we will first briefly explain the likelihood function and maximum likelihood estimates for regression.</p>
<p>Let <span class="math inline">\(\mathbf{Y}\)</span> be <span class="math inline">\(n \times 1\)</span> matrix of responses, <span class="math inline">\(\mathbf{X}\)</span>, the <span class="math inline">\(n \times (p+1)\)</span> matrix of predictors, and <span class="math inline">\(\boldsymbol{\beta}\)</span>, <span class="math inline">\((p+1) \times 1\)</span> matrix of coefficients. If the multiple linear regression model is correct then,</p>
<span class="math display">\[\begin{equation}
\label{norm-assumption}
\mathbf{Y} \sim N(\mathbf{X}\boldsymbol{\beta}, \sigma^2)
\end{equation}\]</span>
<p>When we do linear regression, our goal is to estimate the unknown parameters <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma^2\)</span> from (). In <a href="https://github.com/STA210-Sp19/supplemental-notes/blob/master/regression-basics-matrix.pdf">Matrix Form of Linear Regression</a>, we showed a way to estimate these parameters using matrix alegbra. Another approach for estimating <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma^2\)</span> is using <em>maximum likelihood estimation</em>.</p>
<p>A <strong>likelihood function</strong> is used to summarise the evidence from the data in support of each possible value of a model parameter. Using (), we will write the likelihood function for linear regression as</p>
<span class="math display">\[\begin{equation}
\label{lr}
L(\mathbf{X}, \mathbf{Y}|\boldsymbol{\beta}, \sigma^2) = \prod\limits_{i=1}^n (2\pi \sigma^2)^{-\frac{1}{2}} \exp\bigg\{-\frac{1}{2\sigma^2}\sum\limits_{i=1}^n(Y_i - \mathbf{X}_i \boldsymbol{\beta})^T(Y_i - \mathbf{X}_i \boldsymbol{\beta})\bigg\}
\end{equation}\]</span>
<p>where <span class="math inline">\(Y_i\)</span> is the <span class="math inline">\(i^{th}\)</span> response and <span class="math inline">\(\mathbf{X}_i\)</span> is the vector of predictors for the <span class="math inline">\(i^{th}\)</span> observation. One approach estimating <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma^2\)</span> is to find the values of those parameters that maximize the likelihood in (), i.e. <strong>maximum likelhood estimation</strong>. To make the calculations more manageable, instead of maximizing the likelihood function, we will instead maximize its logarithm, i.e. the log-likelihood function. The values of the parameters that maximize the log-likelihood function are those that maximize the likelihood function. The log-likelihood function we will maximize is</p>
<span class="math display">\[\begin{equation}
\label{logL}
\begin{aligned}
\log L(\mathbf{X}, \mathbf{Y}|\boldsymbol{\beta}, \sigma^2) &amp;= \sum\limits_{i=1}^n -\frac{1}{2}\log(2\pi\sigma^2) -\frac{1}{2\sigma^2}\sum\limits_{i=1}^n(Y_i - \mathbf{X}_i \boldsymbol{\beta})^T(Y_i - \mathbf{X}_i \boldsymbol{\beta}) \\[10pt]
&amp;= -\frac{n}{2}\log(2\pi\sigma^2) - \frac{1}{2\sigma^2}(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta})^T(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta})\\
\end{aligned}
\end{equation}\]</span>
<p>[–insert details MLES–]</p>
<p>The maximum likelihood estimate of <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma^2\)</span> are</p>
<span class="math display">\[\begin{equation}
\label{mle}
\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y} \hspace{10mm} \hat{\sigma}^2 = \frac{1}{n}(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta})^T(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta}) = \frac{1}{n}RSS
\end{equation}\]</span>
<p>where <span class="math inline">\(RSS\)</span> is the residual sum of squares. Note that the maximum likelihood estimate is not exactly equal to the estimate of <span class="math inline">\(\sigma^2\)</span> we typically use <span class="math inline">\(\frac{RSS}{n-p-1}\)</span>. This is because the maximum likelihood estimate of <span class="math inline">\(\sigma^2\)</span> in () is a <em>biased</em> estimator of <span class="math inline">\(\sigma^2\)</span>. When <span class="math inline">\(n\)</span> is much larger than the number of predictors <span class="math inline">\(p\)</span>, then the differences in these two estimates are trivial.</p>
</div>
<div id="aic" class="section level3">
<h3><span class="header-section-number">6.3.2</span> AIC</h3>
<p>Akaike’s Information Criterion (AIC) is</p>
<span class="math display">\[\begin{equation}
\label{aic}
AIC = -2 \log L + 2(p+1)
\end{equation}\]</span>
<p>where <span class="math inline">\(\log L\)</span> is the log-likelihood. This is the general form of AIC that can be applied to a variety of models, but for now, let’s focus on AIC for mutliple linear regression.</p>
<span class="math display">\[\begin{equation}
\label{aic-reg}
\begin{aligned}
AIC &amp;= -2 \log L + 2(p+1) \\[10pt]
&amp;= -2\bigg[-\frac{n}{2}\log(2\pi\sigma^2) - \frac{1}{2\sigma^2}(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta})^T(\mathbf{Y} - \mathbf{X} \boldsymbol{\beta})\bigg] + 2(p+1) \\[10pt]
&amp;= n\log\big(2\pi\frac{RSS}{n}\big) + \frac{1}{RSS/n}RSS \\[10pt]
&amp;= n\log(2\pi) + n\log(RSS) - n\log(n) + 2(p+1)
\end{aligned}
\end{equation}\]</span>
</div>
<div id="bic" class="section level3">
<h3><span class="header-section-number">6.3.3</span> BIC</h3>
<p>[—]</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-mlr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7-logistic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["intro-regression.pdf", "intro-regression.epub"],
"toc": {
"collapse": "section",
"toc_depth": 1,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
