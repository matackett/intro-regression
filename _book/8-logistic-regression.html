<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 8 Logistic Regression | Intro to Regression Analysis</title>
  <meta name="description" content="This document contains lab assignments and other materials for an intermediate-level regression course.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content=" 8 Logistic Regression | Intro to Regression Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.introregression.org/" />
  
  <meta property="og:description" content="This document contains lab assignments and other materials for an intermediate-level regression course." />
  <meta name="github-repo" content="matackett/intro-regression" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Logistic Regression | Intro to Regression Analysis" />
  
  <meta name="twitter:description" content="This document contains lab assignments and other materials for an intermediate-level regression course." />
  

<meta name="author" content="Maria Tackett">


<meta name="date" content="2019-05-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="7-model-selection.html">
<link rel="next" href="9-multinomial-logistic-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Materials for an Intro Regression Course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Beginning of the Book</a></li>
<li class="part"><span><b>I In-class Exercises</b></span></li>
<li class="chapter" data-level="2" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html"><i class="fa fa-check"></i><b>2</b> Movies Analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#analysis"><i class="fa fa-check"></i><b>2.2</b> Analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#part-1"><i class="fa fa-check"></i><b>2.2.1</b> Part 1</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#part-2"><i class="fa fa-check"></i><b>2.2.2</b> Part 2</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#next-steps"><i class="fa fa-check"></i><b>2.3</b> Next Steps</a></li>
<li class="chapter" data-level="2.4" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#discussion-questions"><i class="fa fa-check"></i><b>2.4</b> Discussion Questions</a></li>
<li class="chapter" data-level="2.5" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#references"><i class="fa fa-check"></i><b>2.5</b> References</a></li>
<li class="chapter" data-level="2.6" data-path="2-movies-analysis.html"><a href="2-movies-analysis.html#appendix"><i class="fa fa-check"></i><b>2.6</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-advertising-analysis.html"><a href="3-advertising-analysis.html"><i class="fa fa-check"></i><b>3</b> Advertising Analysis</a><ul>
<li class="chapter" data-level="3.1" data-path="3-advertising-analysis.html"><a href="3-advertising-analysis.html#data-and-packages"><i class="fa fa-check"></i><b>3.1</b> Data and packages</a></li>
<li class="chapter" data-level="3.2" data-path="3-advertising-analysis.html"><a href="3-advertising-analysis.html#analysis-1"><i class="fa fa-check"></i><b>3.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-analyzing-beer-data.html"><a href="4-analyzing-beer-data.html"><i class="fa fa-check"></i><b>4</b> Analyzing Beer Data</a></li>
<li class="chapter" data-level="5" data-path="5-analyzing-wages.html"><a href="5-analyzing-wages.html"><i class="fa fa-check"></i><b>5</b> Analyzing Wages</a><ul>
<li class="chapter" data-level="5.0.1" data-path="5-analyzing-wages.html"><a href="5-analyzing-wages.html#initial-model"><i class="fa fa-check"></i><b>5.0.1</b> Initial model</a></li>
<li class="chapter" data-level="5.0.2" data-path="5-analyzing-wages.html"><a href="5-analyzing-wages.html#model-with-mean-centered-variables"><i class="fa fa-check"></i><b>5.0.2</b> Model with mean-centered variables</a></li>
<li class="chapter" data-level="5.0.3" data-path="5-analyzing-wages.html"><a href="5-analyzing-wages.html#model-with-indicator-variables"><i class="fa fa-check"></i><b>5.0.3</b> Model with indicator variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-exam-01-review.html"><a href="6-exam-01-review.html"><i class="fa fa-check"></i><b>6</b> Exam 01 Review</a><ul>
<li class="chapter" data-level="6.0.1" data-path="6-exam-01-review.html"><a href="6-exam-01-review.html#main-effects-model"><i class="fa fa-check"></i><b>6.0.1</b> Main Effects Model</a></li>
<li class="chapter" data-level="6.1" data-path="6-exam-01-review.html"><a href="6-exam-01-review.html#model-with-interactions"><i class="fa fa-check"></i><b>6.1</b> Model with Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-model-selection.html"><a href="7-model-selection.html"><i class="fa fa-check"></i><b>7</b> Model Selection</a><ul>
<li class="chapter" data-level="7.1" data-path="7-model-selection.html"><a href="7-model-selection.html#backward-selection-manually"><i class="fa fa-check"></i><b>7.1</b> Backward selection “manually”</a></li>
<li class="chapter" data-level="7.2" data-path="7-model-selection.html"><a href="7-model-selection.html#backward-selection-using-regsubsets"><i class="fa fa-check"></i><b>7.2</b> Backward selection using regsubsets</a></li>
<li class="chapter" data-level="7.3" data-path="7-model-selection.html"><a href="7-model-selection.html#changing-selection-criteria"><i class="fa fa-check"></i><b>7.3</b> Changing selection criteria</a></li>
<li class="chapter" data-level="7.4" data-path="7-model-selection.html"><a href="7-model-selection.html#different-selection-procedure"><i class="fa fa-check"></i><b>7.4</b> Different selection procedure</a></li>
<li class="chapter" data-level="7.5" data-path="7-model-selection.html"><a href="7-model-selection.html#choosing-a-final-model"><i class="fa fa-check"></i><b>7.5</b> Choosing a final model</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-logistic-regression.html"><a href="8-logistic-regression.html"><i class="fa fa-check"></i><b>8</b> Logistic Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="8-logistic-regression.html"><a href="8-logistic-regression.html#references-1"><i class="fa fa-check"></i><b>8.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-multinomial-logistic-regression.html"><a href="9-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>9</b> Multinomial Logistic Regression</a><ul>
<li class="chapter" data-level="9.0.1" data-path="9-multinomial-logistic-regression.html"><a href="9-multinomial-logistic-regression.html#questions"><i class="fa fa-check"></i><b>9.0.1</b> Questions</a></li>
<li class="chapter" data-level="9.0.2" data-path="9-multinomial-logistic-regression.html"><a href="9-multinomial-logistic-regression.html#references-2"><i class="fa fa-check"></i><b>9.0.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-dealing-with-missing-data.html"><a href="10-dealing-with-missing-data.html"><i class="fa fa-check"></i><b>10</b> Dealing with Missing Data</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1">
<h1><span class="header-section-number"> 8</span> Logistic Regression</h1>
<p>The goal of this exercise is to walk through a logistic regression analysis. It will give you a basic idea of the analysis steps and thought-process; however, due to class time constraints, this analysis is not exhaustive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(rms)
## add any other packages as needed </code></pre></div>
<p>This data is from an ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. The goal is to predict whether a patient has a 10-year risk of future coronary heart disease. The dataset includes the following:</p>
<ul>
<li><code>male</code>: 0 = Female; 1 = Male</li>
<li><code>age</code>: Age at exam time.</li>
<li><code>education</code>: 1 = Some High School; 2 = High School or GED; 3 = Some College or Vocational School; 4 = College</li>
<li><code>currentSmoker</code>: 0 = nonsmoker; 1 = smoker</li>
<li><code>cigsPerDay</code>: number of cigarettes smoked per day (estimated average)</li>
<li><code>BPMeds</code>: 0 = Not on Blood Pressure medications; 1 = Is on Blood Pressure medications</li>
<li><code>prevalentStroke</code></li>
<li><code>prevalentHyp</code></li>
<li><code>diabetes</code>: 0 = No; 1 = Yes</li>
<li><code>totChol</code>: total cholesterol (mg/dL)</li>
<li><code>sysBP</code>: systolic blood pressure (mmHg)</li>
<li><code>diaBP</code>: diastolic blood pressure (mmHg)</li>
<li><code>BMI</code>: BodyMass Index calculated as: Weight (kg) / Height(meter-squared)</li>
<li><code>heartRate</code> Beats/Min (Ventricular)</li>
<li><code>glucose</code>: total glucose mg/dL</li>
<li><code>TenYearCHD</code>: 0 = Patient doesn’t have 10-year risk of future coronary heart disease; 1 = Patient has 10-year risk of future coronary heart disease;</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fram_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/framingham.csv&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">education =</span> <span class="kw">case_when</span>(
    education <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Some HS&quot;</span>, 
    education <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">~</span><span class="st"> &quot;HS or GED&quot;</span>, 
    education <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> &quot;Some College&quot;</span>, 
    education <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> &quot;College&quot;</span>
  ),
  <span class="dt">currentSmoker =</span> <span class="kw">if_else</span>(currentSmoker <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;nonsmoker&quot;</span>, <span class="st">&quot;smoker&quot;</span>),
  <span class="dt">diabetes =</span> <span class="kw">if_else</span>(diabetes <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>),
  <span class="dt">male =</span> <span class="kw">factor</span>(male)
  )</code></pre></div>
<ul>
<li><p>Fit a full model (main effects only) with <code>TenYearCHD</code> as the response. Display the model output.</p></li>
<li><p>Based on the goal of the analysis, should the full model be the final model? Why or why not?</p></li>
<li>Use the <code>step</code> function to conduct backward model selection. What is selection criteria used by the <code>step</code> function?
<ul>
<li>Display the final model.</li>
</ul></li>
<li>There is reason to believe that the factors related to coronary heart disease may have different effects for men and women. We would like to include this information in the model. Use the drop-in-deviance test to test at least three interactions with <code>male</code>.
<ul>
<li>Which interactions did you choose? Why?</li>
<li>Include the output from the tests.</li>
</ul></li>
<li><p>Use the results from model selection and the drop-in-deviance test to select a final model. Display the model below.</p></li>
<li><p>Plot and analyze the binned residuals for the final model. Include all appropriate plots. What is your assessment on the model fit based on these plots?</p></li>
<li><p>Plot and analyze the ROC curve. Based on the ROC curve, does the model fit the data well?</p></li>
<li><p>A doctor plans to use the results from your model to help select patients for a new heart disease prevention program. She asks you which threshold would be best to select patients for this program. What threshold would you recommend to the doctor? Why?</p></li>
</ul>
<div id="references-1" class="section level2">
<h2><span class="header-section-number">8.1</span> References</h2>
<ul>
<li>Data obtained from <a href="https://www.kaggle.com/neisha/heart-disease-prediction-using-logistic-regression/data" class="uri">https://www.kaggle.com/neisha/heart-disease-prediction-using-logistic-regression/data</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7-model-selection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="9-multinomial-logistic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["introregression.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
