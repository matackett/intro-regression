<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2.2 Data Wrangling &amp; Multiple Linear Regression | Intro to Regression Analysis</title>
  <meta name="description" content="This document contains lab assignments and other materials for an intermediate-level regression course.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2.2 Data Wrangling &amp; Multiple Linear Regression | Intro to Regression Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This document contains lab assignments and other materials for an intermediate-level regression course." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 Data Wrangling &amp; Multiple Linear Regression | Intro to Regression Analysis" />
  
  <meta name="twitter:description" content="This document contains lab assignments and other materials for an intermediate-level regression course." />
  

<meta name="author" content="Maria Tackett">


<meta name="date" content="2019-05-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="2-1-multiple-linear-regression.html">
<link rel="next" href="2-3-analyzing-wages.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Broadening Your Statistical Horizons</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Beginning of the Book</a></li>
<li class="chapter" data-level="2" data-path="2-mlr.html"><a href="2-mlr.html"><i class="fa fa-check"></i><b>2</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-multiple-linear-regression.html"><a href="2-1-multiple-linear-regression.html"><i class="fa fa-check"></i><b>2.1</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-1-multiple-linear-regression.html"><a href="2-1-multiple-linear-regression.html#packages"><i class="fa fa-check"></i><b>2.1.1</b> Packages</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-1-multiple-linear-regression.html"><a href="2-1-multiple-linear-regression.html#data"><i class="fa fa-check"></i><b>2.1.2</b> Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-1-multiple-linear-regression.html"><a href="2-1-multiple-linear-regression.html#exercises"><i class="fa fa-check"></i><b>2.1.3</b> Exercises</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-1-multiple-linear-regression.html"><a href="2-1-multiple-linear-regression.html#acknowledgement"><i class="fa fa-check"></i><b>2.1.4</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-data-wrangling-multiple-linear-regression.html"><a href="2-2-data-wrangling-multiple-linear-regression.html"><i class="fa fa-check"></i><b>2.2</b> Data Wrangling &amp; Multiple Linear Regression</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-2-data-wrangling-multiple-linear-regression.html"><a href="2-2-data-wrangling-multiple-linear-regression.html#packages-1"><i class="fa fa-check"></i><b>2.2.1</b> Packages</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-2-data-wrangling-multiple-linear-regression.html"><a href="2-2-data-wrangling-multiple-linear-regression.html#data-1"><i class="fa fa-check"></i><b>2.2.2</b> Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-2-data-wrangling-multiple-linear-regression.html"><a href="2-2-data-wrangling-multiple-linear-regression.html#exercises-1"><i class="fa fa-check"></i><b>2.2.3</b> Exercises</a></li>
<li class="chapter" data-level="2.2.4" data-path="2-2-data-wrangling-multiple-linear-regression.html"><a href="2-2-data-wrangling-multiple-linear-regression.html#acknowledgement-1"><i class="fa fa-check"></i><b>2.2.4</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-analyzing-wages.html"><a href="2-3-analyzing-wages.html"><i class="fa fa-check"></i><b>2.3</b> Analyzing Wages</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-3-analyzing-wages.html"><a href="2-3-analyzing-wages.html#initial-model"><i class="fa fa-check"></i><b>2.3.1</b> Initial model</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-3-analyzing-wages.html"><a href="2-3-analyzing-wages.html#model-with-mean-centered-variables"><i class="fa fa-check"></i><b>2.3.2</b> Model with mean-centered variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-3-analyzing-wages.html"><a href="2-3-analyzing-wages.html#model-with-indicator-variables"><i class="fa fa-check"></i><b>2.3.3</b> Model with indicator variables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-matrix-form-of-linear-regression.html"><a href="2-4-matrix-form-of-linear-regression.html"><i class="fa fa-check"></i><b>2.4</b> Matrix Form of Linear Regression</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-4-matrix-form-of-linear-regression.html"><a href="2-4-matrix-form-of-linear-regression.html#introduction"><i class="fa fa-check"></i><b>2.4.1</b> Introduction</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-4-matrix-form-of-linear-regression.html"><a href="2-4-matrix-form-of-linear-regression.html#matrix-form-for-the-regression-model"><i class="fa fa-check"></i><b>2.4.2</b> Matrix Form for the Regression Model</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-4-matrix-form-of-linear-regression.html"><a href="2-4-matrix-form-of-linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>2.4.3</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-4-matrix-form-of-linear-regression.html"><a href="2-4-matrix-form-of-linear-regression.html#variance-covariance-matrix-of-the-coefficients"><i class="fa fa-check"></i><b>2.4.4</b> Variance-covariance matrix of the coefficients</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-5-log-transformations-in-linear-regression.html"><a href="2-5-log-transformations-in-linear-regression.html"><i class="fa fa-check"></i><b>2.5</b> Log Transformations in Linear Regression</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-5-log-transformations-in-linear-regression.html"><a href="2-5-log-transformations-in-linear-regression.html#log-transformation-on-the-response-variable"><i class="fa fa-check"></i><b>2.5.1</b> Log-transformation on the response variable</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-5-log-transformations-in-linear-regression.html"><a href="2-5-log-transformations-in-linear-regression.html#log-transformation-on-the-predictor-variable"><i class="fa fa-check"></i><b>2.5.2</b> Log-transformation on the predictor variable</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-5-log-transformations-in-linear-regression.html"><a href="2-5-log-transformations-in-linear-regression.html#log-transformation-on-the-the-response-and-predictor-variable"><i class="fa fa-check"></i><b>2.5.3</b> Log-transformation on the the response and predictor variable</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html"><i class="fa fa-check"></i><b>2.6</b> Details about Model Diagnostics</a><ul>
<li class="chapter" data-level="2.6.1" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html#introduction-1"><i class="fa fa-check"></i><b>2.6.1</b> Introduction</a></li>
<li class="chapter" data-level="2.6.2" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html#matrix-form-for-the-regression-model-1"><i class="fa fa-check"></i><b>2.6.2</b> Matrix Form for the Regression Model</a></li>
<li class="chapter" data-level="2.6.3" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html#hat-matrix-leverage"><i class="fa fa-check"></i><b>2.6.3</b> Hat Matrix &amp; Leverage</a></li>
<li class="chapter" data-level="2.6.4" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html#standardized-residuals"><i class="fa fa-check"></i><b>2.6.4</b> Standardized Residuals</a></li>
<li class="chapter" data-level="2.6.5" data-path="2-6-details-about-model-diagnostics.html"><a href="2-6-details-about-model-diagnostics.html#cooks-distance"><i class="fa fa-check"></i><b>2.6.5</b> Cook’s Distance</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling-multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">2.2</span> Data Wrangling &amp; Multiple Linear Regression</h2>
<p>When doing statistical analyses in practice, there is often a lot of time spent on cleaning and preparing the data. The goal of today’s lab is to practice cleaning messy data, so it can be used in a regression analysis. You will also practice interpreting the results from a regression model that has numeric and categorical predictors and a log-transformed response variable.</p>
<div id="packages-1" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Packages</h3>
<p>We will use the following packages in today’s lab.</p>
</div>
<div id="data-1" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Data</h3>
<p>Today’s data is about Airbnb listings in Asheville, NC. The data was obtained from <a href="http://insideairbnb.com/index.html">http://insideairbnb.com/</a>; it was originally scraped from <a href="https://www.airbnb.com/">airbnb.com</a>.</p>
<p>You can see a visualization of some of the data used in today’s lab at <a href="http://insideairbnb.com/asheville/" class="uri">http://insideairbnb.com/asheville/</a>.</p>
<p>We will use the following variables in this lab:</p>
<ul>
<li><code>price</code>: Cost per night (in U.S. dollars)</li>
<li><code>cleaning_fee</code>: Cleaning fee (in U.S. dollars)</li>
<li><code>property_type</code>: Type of dwelling (House, Apartment, etc.)</li>
<li><code>room_type</code>:
<ul>
<li><em>Entire home/apt</em> (guests have entire place to themselves)</li>
<li><em>Private room</em> (Guests have private room to sleep, all other rooms shared)</li>
<li><em>Shared room</em> (Guests sleep in room shared with others)</li>
</ul></li>
<li><code>number_of_reviews</code>: Total number of reviews for the listing</li>
<li><code>review_scores_rating</code>: Average review score (0 - 100)</li>
</ul>
</div>
<div id="exercises-1" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Exercises</h3>
<div id="data-wrangling" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> Data wrangling</h4>
<ol style="list-style-type: decimal">
<li>We would like to use variables from both the <code>basic_info</code> and <code>details</code> data frames in this analysis. Both dataframes have the variable <code>id</code> that uniquely identifies each Airbnb listing. Because we need data from <code>basic_info</code> and <code>details</code>, we only want to include observations that are in both the <code>basic_info</code> and <code>details</code> datasets. Therefore, we will use an <code>inner_join</code> to combine the two data sets. (Note: Both data frames include a variable called <code>id</code> that uniquely identifies each Airbnb listing. R will use this variable to join the two data frames.)</li>
</ol>
<p>How many observations are in <code>airbnb</code>? How many variables?</p>
<ol start="2" style="list-style-type: decimal">
<li>Some Airbnb rentals have cleaning fees, and we want to include the cleaning fee when we calculate the total rental cost. Use the code below to see how the data in the column <code>cleaning_fee</code> is currently stored in the <code>airbnb</code> data frame.</li>
</ol>
<p>The column <code>cleaning_fee</code> currently contains what type of data? Why do you think the data is stored this way even though <code>cleaning_fee</code> is a quantitative variable?</p>
<ol start="3" style="list-style-type: decimal">
<li>Since <code>cleaning_fee</code> is a quantitative variable, we need to make sure it is stored as numeric data in the dataframe. To do so, we will first use the <code>extract</code> function in <code>tidyr</code> package to create a column of cleaning fees that don’t have the dollar sign. Then, we will use the <code>as.numeric()</code> function to make the extracted data the numeric data type <code>double</code>.</li>
</ol>
<p>Use the <code>typeof</code> function to confirm that <code>cleaning_fee</code> is now stored as a <code>double</code> data type.</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Use the <code>skim</code> function to view a summary of the <code>cleaning_fee</code> data. How many observations have missing values for <code>cleaning_fee</code>? What do you think is the most likely reason for the missing observations of <code>cleaning_fee</code>? In other words, what does a missing value of <code>cleaning_fee</code> indicate?</p></li>
<li><p>Fill in the code below to impute the missing values of <code>cleaning_fee</code> with an appropriate numeric value. Then use the <code>skim</code> function to confirm that there are no longer missing values of <code>cleaning_fee</code>.</p></li>
</ol>
<p><em>This is an example of data that is missing not at random, since there is a specific pattern/explanation to the misisng data. We will talk more about dealing with missing data later in the semester.</em></p>
<ol start="6" style="list-style-type: decimal">
<li>Next, we look at the variable <code>property_type</code>.
<ul>
<li>Use the <code>count</code> function to determine how many categories are in the variable <code>property</code> and the frequency of each category.</li>
<li>What are the top 4 most common property types? These make up what proportion of the observations?</li>
</ul></li>
<li>Since an overwhelming majority of the observations in the data are one of the top 4 property types, we would like to create a simplified version of the <code>proprety_type</code> variable that has 5 categories: <em>House</em>, <em>Apartment</em>, <em>Guest suite</em>, <em>Bungalow</em>, and <em>Other</em>. Fill in the code below to create <code>prop_type_simp</code>.</li>
</ol>
<p>Use the code below to check that <code>prop_type_simp</code> was correctly made.</p>
<ol start="8" style="list-style-type: decimal">
<li>Airbnb is most commonly used for travel purposes, i.e. as an alternative to traditional hotels. We only want to include Airbnb listings in our regression analysis that are intended for travel purposes. What are the 5 most common values for the variable <code>minimum_nights</code>? Which value in the top 5 stands out? What is the likely intended purpose for Airbnb listings with this seemingly unusual value for <code>minimum_nights</code>?</li>
</ol>
<p>Filter the <code>airbnb</code> data so that it only includes observations with <code>minimum_nights &lt;= 3</code>. You will use this filtered dataset for the remainder of the lab.</p>
</div>
<div id="regression-analysis" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> Regression Analysis</h4>
<ol start="9" style="list-style-type: decimal">
<li><p>For the response variable, will use the cost to stay at an Airbnb location for 3 nights. Create a new variable called <code>price_3_nights</code> that uses <code>price</code> and <code>cleaning_fee</code> to calculate the total cost to stay at the Airbnb property for 3 nights. Be sure to add this variable to your dataframe.</p></li>
<li><p>Use histograms to examine the distributions of <code>price_3_nights</code> and <code>log(price_3_nights)</code>. Based on the histograms, which variable should you use for the regression model? Briefly explain.</p></li>
</ol>
<p>Use this variable as the response for the remainder of the lab.</p>
<ol start="11" style="list-style-type: decimal">
<li><p>Fit a regression model called <code>model1</code> with the response variable from the previous question and the following predictor variables: <code>prop_type_simp</code>, <code>number_of_reviews</code>, and <code>review_scores_rating</code>. Display the model output.</p></li>
<li><p>Interpret the coefficient <code>review_scores_rating</code> in terms of <code>price_3_nights</code>.</p></li>
<li><p>Interpret the coefficient of <code>prop_type_simpGuest suite</code> in terms of <code>price_3_nights</code>.</p></li>
<li><p>We want to determine if <code>room_type</code> is a significant predictor of the cost for 3 nights, given everything else in the model. Fit a regression model called <code>model2</code> that includes all of the predictor variables in <code>model1</code> and <code>room_type</code>. Display the model output.</p></li>
</ol>
<p>Use the code below to conduct a Nested F test to determine if <code>room_type</code> is a significant predictor of the minimum cost. What is your conclusion from the Nested F test?</p>
<ol start="15" style="list-style-type: decimal">
<li>Suppose you are planning to visit Asheville over spring break, and you want to stay in an Airbnb. You find an Airbnb that is an apartment with a private room, has 10 reviews, and an average rating of 90. Use <code>model2</code> to predict the total cost to stay at this Airbnb for 3 nights. Include the appropriate 95% interval with your prediction. Report the prediction and interval in terms of <code>price_3_nights</code>.</li>
</ol>
<p><em>You’re done! Commit all remaining changes, use the commit message “Done with Lab 5!”, and push. Before you wrap up the assignment, make sure the .Rmd and .md documents are updated in your GitHub repo. There is a 10% penalty if the .Rmd file has to be knitted to display graphs, i.e. the graphs are not showing in the .md file on GitHub.</em></p>
</div>
</div>
<div id="acknowledgement-1" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Acknowledgement</h3>
<p>The data from this lab is from <a href="http://insideairbnb.com/index.html">insideairbnb.com</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-1-multiple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2-3-analyzing-wages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["intro-regression.pdf", "intro-regression.epub"],
"toc": {
"collapse": "section",
"toc_depth": 1,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
